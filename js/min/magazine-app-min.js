function loadApp(){$("#canvas").fadeIn(1e3);var o=$(".magazine");return 0==o.width()||0==o.height()?void setTimeout(loadApp,10):(o.turn({width:700,height:910,duration:1e3,acceleration:!isChrome(),gradients:!0,autoCenter:!0,elevation:50,pages:12,display:"single",when:{turning:function(o,n,e){var i=$(this),t=i.turn("page"),s=i.turn("pages");Hash.go("page/"+n).update(),disableControls(n),$(".thumbnails .page-"+t).parent().removeClass("current"),$(".thumbnails .page-"+n).parent().addClass("current")},turned:function(o,n,e){disableControls(n),$(this).turn("center"),1==n&&$(this).turn("peel","br")},missing:function(o,n){for(var e=0;e<n.length;e++)addPage(n[e],$(this))}}}),$(".magazine-viewport").zoom({flipbook:$(".magazine"),max:function(){var o=$(window).width();return o/$(".magazine").width()},when:{swipeLeft:function(){$(this).zoom("flipbook").turn("next")},swipeRight:function(){$(this).zoom("flipbook").turn("previous")},resize:function(o,n,e,i){1==n?loadSmallPage(e,i):loadLargePage(e,i)},zoomIn:function(){$(".thumbnails").hide(),$(".made").hide(),$(".magazine").removeClass("animated").addClass("zoom-in"),$(".zoom-icon").removeClass("zoom-icon-in").addClass("zoom-icon-out"),window.escTip||$.isTouch||(escTip=!0,$("<div />",{"class":"exit-message"}).html("<div>Press ESC to exit</div>").appendTo($("body")).delay(2e3).animate({opacity:0},500,function(){$(this).remove()}))},zoomOut:function(){$(".exit-message").hide(),$(".thumbnails").fadeIn(),$(".made").fadeIn(),$(".zoom-icon").removeClass("zoom-icon-out").addClass("zoom-icon-in"),setTimeout(function(){$(".magazine").addClass("animated").removeClass("zoom-in"),resizeViewport()},0)}}}),$.isTouch?$(".magazine-viewport").bind("zoom.doubleTap",zoomTo):$(".magazine-viewport").bind("zoom.tap",zoomTo),$(document).keydown(function(o){var n=37,e=39,i=27;switch(o.keyCode){case n:$(".magazine").turn("previous"),o.preventDefault();break;case e:$(".magazine").turn("next"),o.preventDefault();break;case i:$(".magazine-viewport").zoom("zoomOut"),o.preventDefault()}}),Hash.on("^page/([0-9]*)$",{yep:function(o,n){var e=n[1];void 0!==e&&$(".magazine").turn("is")&&$(".magazine").turn("page",e)},nop:function(o){$(".magazine").turn("is")&&$(".magazine").turn("page",1)}}),$(window).resize(function(){resizeViewport()}).bind("orientationchange",function(){resizeViewport()}),$(".thumbnails").click(function(o){var n;o.target&&(n=/page-([0-9]+)/.exec($(o.target).attr("class")))&&$(".magazine").turn("page",n[1])}),$(".thumbnails li").bind($.mouseEvents.over,function(){$(this).addClass("thumb-hover")}).bind($.mouseEvents.out,function(){$(this).removeClass("thumb-hover")}),$.isTouch?$(".thumbnails").addClass("thumbanils-touch").bind($.mouseEvents.move,function(o){o.preventDefault()}):$(".thumbnails ul").mouseover(function(){$(".thumbnails").addClass("thumbnails-hover")}).mousedown(function(){return!1}).mouseout(function(){$(".thumbnails").removeClass("thumbnails-hover")}),$.isTouch?$(".magazine").bind("touchstart",regionClick):$(".magazine").click(regionClick),$(".next-button").bind($.mouseEvents.over,function(){$(this).addClass("next-button-hover")}).bind($.mouseEvents.out,function(){$(this).removeClass("next-button-hover")}).bind($.mouseEvents.down,function(){$(this).addClass("next-button-down")}).bind($.mouseEvents.up,function(){$(this).removeClass("next-button-down")}).click(function(){$(".magazine").turn("next")}),$(".previous-button").bind($.mouseEvents.over,function(){$(this).addClass("previous-button-hover")}).bind($.mouseEvents.out,function(){$(this).removeClass("previous-button-hover")}).bind($.mouseEvents.down,function(){$(this).addClass("previous-button-down")}).bind($.mouseEvents.up,function(){$(this).removeClass("previous-button-down")}).click(function(){$(".magazine").turn("previous")}),resizeViewport(),void $(".magazine").addClass("animated"))}$(".zoom-icon").bind("mouseover",function(){$(this).hasClass("zoom-icon-in")&&$(this).addClass("zoom-icon-in-hover"),$(this).hasClass("zoom-icon-out")&&$(this).addClass("zoom-icon-out-hover")}).bind("mouseout",function(){$(this).hasClass("zoom-icon-in")&&$(this).removeClass("zoom-icon-in-hover"),$(this).hasClass("zoom-icon-out")&&$(this).removeClass("zoom-icon-out-hover")}).bind("click",function(){$(this).hasClass("zoom-icon-in")?$(".magazine-viewport").zoom("zoomIn"):$(this).hasClass("zoom-icon-out")&&$(".magazine-viewport").zoom("zoomOut")}),$("#canvas").hide(),yepnope({test:Modernizr.csstransforms,yep:["../../js/turnjs/turn.js"],nope:["../../js/turnjs/turn.html4.min.js"],both:["../../js/turnjs/zoom.min.js","../../js/turnjs/magazine.js","../../css/turnjs/magazine.css"],complete:loadApp});